# 중요한 IF / CASE 문법

## IF()

경우에 따라 다른 값을 출력하려면

```
IF (조건식, 참이면출력할값, 거짓이면출력할값)
```

예:

```
select if(1 + 2 = 3, 'aaa', 'bbb')
```

다만, IF()문법은 양자택일(JavaScript의 삼항 연산자)밖에 하지 못한다.

## CASE 문법

```
CASE
  WHEN 조건식1 THEN 남길값1
  WHEN 조건식2 THEN 남길값2
  WHEN 조건식3 THEN 남길값3
  WHEN 조건식4 THEN 남길값4
END
```

만약, 위에서 조건식2, 조건식3이 둘 다 만족하는 값이면 가장 먼저 위치한 '남길값2'를 남기고 CASE 문법을 종료한다.

예:

```
select 사용금액,
case
	when 사용금액 >= 200000 then '우수'
	when 사용금액 >= 100000 and 사용금액 < 200000 then '준수'
	when 사용금액 < 100000 then '그지'
end as 평가
from card c ;
```

결과:

```
사용금액  평가
25000	 그지
238500	 우수
894000	 우수
16000	 그지
152000	 준수
450000	 우수
6000	 그지
780000	 우수
5000	 그지
43000	 그지
90000	 그지
80000	 그지
607000	 우수
123000	 준수
177000	 준수
```

마지막에 ELSE 문법도 사용 가능하다

```
CASE
  WHEN 조건식1 THEN 남길값1
  WHEN 조건식2 THEN 남길값2
  WHEN 조건식3 THEN 남길값3
  WHEN 조건식4 THEN 남길값4
  else 남길값
END
```

## 응용: 집계함수와 함께 사용

```
select sum(3) from card c
```

위와같이 작성하면 'card'테이블의 행의 수만큼 '3'의 값을 sum()한다

### Q. 등급이 vip면 3점, 로열은 2점, 패밀리는 1점일 경우, 모든 고객 점수를 더하면?

```
select sum(
case
	when 고객등급 = 'vip' then 3
	when 고객등급 = '로열' then 2
	when 고객등급 = '패밀리' then 1
end
) as 점수합계 from card c;
```

결과:

```
점수합계
32
```

## 퀴즈

### Q1. card 테이블에서 장부 조작

- 사용금액 30만원 이상은 50% 증액, 30만원 미만은 10% 증액해서
  사용금액의 총 합계 출력. '5147550' 나오면 정답

### Q2. 고객등급 재설정

- 사용금액이 30만원 이상은 'vip'
  20만원 이상 30만원 미만은 '로열'
  그 외엔 '패밀리'로 다시 설정
  고객 등급이 변동될 이름들만 출력
